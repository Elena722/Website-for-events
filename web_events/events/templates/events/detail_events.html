{% extends 'base.html' %}
<!---->
{% block content %}

</div>
<div class="row">
    <div class="col-12 col-md-12 mb-3 mx-1">
        <h4 class="font-italic">Detail: {{ event.title }}</h4>
        {% if event.cover %}
        <a href=""><img src="{{ event.cover.url }}" alt="..." width="430px" height="auto"/></a>
        {% endif %}
        {% if user.is_authenticated %}
        <div class="col-12">
            <div class="d-flex">
                <div class="d-flex justify-content-start">
                    <form action="{% url 'join_event' %}" method="post">{% csrf_token %}
                        {% if is_joined %}
                        <button type="submit" class="btn btn-success" value="{{ event.pk }}" name="event_pk">UnJoin
                        </button>
                        {% else %}
                        <button type="submit" class="btn btn-info" value="{{ event.pk }}" name="event_pk">Join</button>
                        {% endif %}
                        <span><a href="{% url 'members_list' event.pk %}">{{ event.join.all.count }}</a>/{{ event.members_number}}</span>
                    </form>
                </div>
                <div class="d-flex col-10 ml-auto">
                    {% if request.user.is_authenticated %}
                    {% if request.user.is_staff%}
                    <input type="submit" class="btn btn-warning"
                           onclick="location.href='{% url 'update_event_post' event.id %}'" value="Update"/>
                    <input type="submit" class="btn btn-danger"
                           onclick="location.href='{% url 'delete_event_post' event.id %}'" value="Delete"/>
                    {% endif %}
                    {% endif %}
                    {% endif %}
                </div>
            </div>
            <hr>
            <!--        <p class="font-italic">Title: {{ event.title }}</p>-->
            <p class="w-50">Description: {{ event.description }}</p>
            <p>Type: {{event.event_type}}</p>
            <p>Location: {{event.location}}</p>
            <p>When: from {{ event.start_date}} to {{ event.end_date}}</p>
            <p>Time: from {{event.start_time}} to {{event.end_time}}</p>
            <p>Category: {{event.category}}</p>
            <p>Host: {{event.host}}</p>
            <!--request.user.is_staff-->
            <hr>
            {% if request.user.is_authenticated %}
            <a class="btn btn-primary btn-comment" href="{% url 'add_comment' event.id %}">Add comment</a>
            {% endif %}
            <div class="container">
                {% for comment in event.comments.all %}
                <br>
                {% if comment.approved_comment %}
                {% if request.user == comment.author %}
                <div class="w-50 p-3" style="background-color: #eee;">
                    <div class="text-right">
                        <a class="btn btn-danger btn-comment btn-sm"
                           href="{% url 'comment_remove' pk=comment.pk %}">x</a>
                        <a class="btn btn-success btn-comment btn-sm"
                           href="{% url 'comment_update' pk=comment.pk %}">U</a>
                    </div>
                    <p class="font-italic text-right text-secondary">{{ comment.created_date }}</p>
                    <p>{{ comment.text|safe|linebreaks }}</p>
                    <p class="font-italic text-right text-secondary">Author: {{ comment.author }}</p>
                </div>
                {% else %}
                <div class="w-50 p-3" style="background-color: #eee;">
                    <p class="font-italic text-right text-secondary">{{ comment.created_date }}</p>
                    <p>{{ comment.text|safe|linebreaks }}</p>
                    <p class="font-italic text-right text-secondary">Author: {{ comment.author }}</p>
                </div>
                {% endif %}
                {% else %}


                {% if request.user == comment.author %}
                <div class="w-50 p-3" style="background-color: #eee;">
                    <div class="text-right">
                        <a class="btn btn-danger btn-comment btn-sm"
                           href="{% url 'comment_remove' pk=comment.pk %}">x</a>
                        <a class="btn btn-warning btn-comment btn-sm"
                           href="{% url 'comment_approve' pk=comment.pk %}">âœ”</a>
                        <a class="btn btn-success btn-comment btn-sm"
                           href="{% url 'comment_update' pk=comment.pk %}">U</a>
                    </div>
                    <p>{{ comment.text|safe|linebreaks }}</p>
                    <p class="font-italic text-right text-secondary">Author: {{ comment.author }}</p>
                </div>
                {% endif %}
                {% endif %}
                {% empty %}
                <p>No comments</p>
                {% endfor %}
            </div>
        </div>
        {% endblock %}


